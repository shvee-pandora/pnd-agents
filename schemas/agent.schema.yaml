# PND Agent Metadata Schema
# This is the single source of truth for what an agent is.
# Powers: marketplace listing, UI rendering, and execution.

$schema: "http://json-schema.org/draft-07/schema#"
title: PND Agent Metadata Schema
description: Machine-readable schema for agent.yaml files that powers marketplace, UI, and execution
type: object

required:
  - id
  - name
  - description
  - category
  - maturity
  - owner
  - entrypoint

properties:
  id:
    type: string
    description: Unique, stable agent identifier (kebab-case)
    pattern: "^[a-z0-9-]+$"

  name:
    type: string
    description: Human-readable agent name (shown in UI)

  description:
    type: string
    description: Short description for marketplace cards (1-2 lines)
    maxLength: 200

  category:
    type: string
    description: Primary marketplace category
    enum:
      - frontend
      - backend
      - qa
      - security
      - performance
      - devex
      - architecture
      - analytics
      - platform

  subCategory:
    type: string
    description: Optional finer classification (UI filter)

  tags:
    type: array
    description: Searchable keywords
    items:
      type: string

  maturity:
    type: string
    description: Stability level of the agent
    enum:
      - alpha
      - beta
      - stable
      - deprecated

  owner:
    type: object
    description: Team or individual responsible for the agent
    required:
      - team
    properties:
      team:
        type: string
        description: Owning team or squad
      contact:
        type: string
        description: Slack/email contact

  visibility:
    type: string
    description: Who can see/install the agent
    enum:
      - public
      - internal
      - private
    default: internal

  entrypoint:
    type: object
    description: How the agent is executed
    required:
      - type
      - command
    properties:
      type:
        type: string
        description: Runtime environment
        enum:
          - python
          - node
          - shell
      command:
        type: string
        description: CLI command or script entry

  inputs:
    type: array
    description: Inputs required to run the agent
    items:
      type: object
      required:
        - name
        - type
        - required
      properties:
        name:
          type: string
          description: Input parameter name
        type:
          type: string
          description: Input data type
          enum:
            - string
            - number
            - boolean
            - repo
            - branch
            - file
            - json
        required:
          type: boolean
          description: Whether this input is mandatory
        description:
          type: string
          description: Human-readable description of the input
        default:
          description: Default value if not provided

  outputs:
    type: array
    description: Artifacts produced by the agent
    items:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          description: Output artifact type
          enum:
            - site
            - json
            - markdown
            - text
            - pr
            - report
        path:
          type: string
          description: Relative output path (if applicable)
        description:
          type: string
          description: Human-readable description of the output

  capabilities:
    type: array
    description: High-level capabilities (used for meta-agents and chaining)
    items:
      type: string

  dependencies:
    type: object
    description: Runtime dependencies (informational for UI)
    properties:
      python:
        type: array
        description: Python package dependencies
        items:
          type: string
      node:
        type: array
        description: Node.js package dependencies
        items:
          type: string

  installable:
    type: boolean
    description: Whether this agent supports single-click install
    default: true

  version:
    type: string
    description: Agent version (semantic versioning)
    pattern: "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?$"
    default: "0.1.0"

  icon:
    type: string
    description: Icon identifier for UI display

  documentation_url:
    type: string
    description: Link to detailed documentation
    format: uri

  repository_url:
    type: string
    description: Link to source code
    format: uri
